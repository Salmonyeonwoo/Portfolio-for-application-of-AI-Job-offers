<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morpheus - ë³µí•© í•„í„°ë§ ë° ì¡°ê±´ë¶€ ë¶„ì„ ìš”ì•½</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f0f4f8; color: #1f2937; }
        .container { max-width: 900px; margin: 2rem auto; padding: 2rem; background: white; border-radius: 1rem; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); }
        .header { border-bottom: 3px solid #14b8a6; padding-bottom: 1rem; margin-bottom: 2rem; }
        h1 { font-size: 2.25rem; font-weight: 700; color: #0f766e; }
        h2 { font-size: 1.5rem; font-weight: 700; color: #14b8a6; margin-top: 1.5rem; border-left: 4px solid #14b8a6; padding-left: 0.75rem; }
        .tag-group { margin-top: 1rem; }
        .tag { display: inline-block; padding: 0.25rem 0.75rem; margin-right: 0.5rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 500; }
        .tag-morpheus { background-color: #ccfbf1; color: #0d9488; }
        .code-block { background-color: #1f2937; color: #e5e7eb; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; font-family: monospace; }
        .list-item { margin-bottom: 0.5rem; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>[Morpheus] ë³µí•© í•„í„°ë§ ë° ì¡°ê±´ë¶€ ë¶„ì„ ìš”ì•½</h1>
            <p class="text-gray-600 mt-2">FilterStageì™€ ì»¤ìŠ¤í…€ ë¶„ì„ ë¡œì§ì„ í™œìš©í•œ ë‹¤ì¤‘ ì¡°ê±´ ë©”ì‹œì§€ ì„ ë³„ ë° ë³´ì•ˆ ì§€í‘œ ê³„ì‚°</p>
            <div class="tag-group">
                <span class="tag tag-morpheus">Morpheus</span>
            </div>
        </div>

        <h2>í”„ë¡œì íŠ¸ ê°œìš”</h2>
        <p>Morpheus íŒŒì´í”„ë¼ì¸ì—ì„œ **ë³µí•©ì ì¸ ì¡°ê±´(Multiple Conditions)**ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ í•„í„°ë§í•˜ê³ , íŠ¹ì • ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë©”ì‹œì§€ì— ëŒ€í•´ **ì‹¤ì‹œê°„ ë³´ì•ˆ ë¶„ì„ ë¡œì§**ì„ ì ìš©í•˜ëŠ” ë°©ë²•ì„ ì‹¤ìŠµí–ˆìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¨ì¼ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì—ì„œ ë‹¤ì–‘í•œ ë¶„ì„ ë¸Œëœì¹˜ë¥¼ êµ¬ì¶•í•˜ëŠ” ê¸°ë³¸ í† ëŒ€ì…ë‹ˆë‹¤.</p>

        <h2>âš™ï¸ ì£¼ìš” ê¸°ìˆ  ë° ì—­í• </h2>
        <ul class="list-disc ml-6 mt-3">
            <li class="list-item"><strong>ê¸°ìˆ :</strong> Morpheus `FilterStage`, `SinglePortStage` ì»¤ìŠ¤í…€ ìŠ¤í…Œì´ì§€, cuDF ë°ì´í„° ì²˜ë¦¬.</li>
            <li class="list-item"><strong>ë³‘ë ¬ ë³µí•© í•„í„°ë§:</strong> DeserializeStageì˜ ì¶œë ¥ì„ ì—¬ëŸ¬ ê°œì˜ ë…ë¦½ì ì¸ `FilterStage`ì— ë™ì‹œì— ì—°ê²°í•˜ì—¬, íŒ¨í‚· í¬ê¸°, íŠ¹ì • IP ì ‘ê·¼ ë“± **ì„œë¡œ ë‹¤ë¥¸ ì¡°ê±´**ì— ë§ëŠ” ë©”ì‹œì§€ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ë³‘ë ¬ ë¶„ë¦¬í–ˆìŠµë‹ˆë‹¤.</li>
            <li class="list-item"><strong>ì¡°ê±´ë¶€ ë¶„ì„ êµ¬í˜„:</strong> ë“¤ì–´ì˜¨ ë©”ì‹œì§€ì˜ í˜ì´ë¡œë“œ(cuDF)ë¥¼ ë¶„ì„í•˜ì—¬ **ì‹¤íŒ¨ ë¡œê·¸ì¸ íšŸìˆ˜**ì™€ ê°™ì€ ë³´ì•ˆ ì§€í‘œë¥¼ ê³„ì‚°í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” **ì»¤ìŠ¤í…€ ë¶„ì„ ìŠ¤í…Œì´ì§€**ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.</li>
            <li class="list-item"><strong>ë‹¤ë‹¨ê³„ ì „ì²˜ë¦¬:</strong> ë³µì¡í•œ ì „ì²˜ë¦¬ ê³¼ì •ì„ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì—¬ëŸ¬ ì»¤ìŠ¤í…€ ìŠ¤í…Œì´ì§€ë¡œ ë¶„ë¦¬í•˜ê³  ìˆœì°¨ì ìœ¼ë¡œ ì—°ê²°í•˜ì—¬ ëª¨ë“ˆì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.</li>
        </ul>

        <h2>ğŸ› ï¸ ì£¼ìš” êµ¬í˜„ ë‚´ìš© (ì‹¤íŒ¨ ë¡œê·¸ì¸ ë¶„ì„ ë¡œì§)</h2>
        <ul class="list-disc ml-6 mt-3">
            <li class="list-item"><strong>ë°ì´í„° ì§‘ê³„:</strong> ì»¤ìŠ¤í…€ ìŠ¤í…Œì´ì§€ ë‚´ì—ì„œ cuDFì˜ `groupby()` ë° `merge()` ì—°ì‚°ì„ ì‚¬ìš©í•˜ì—¬ 'failure' ìƒíƒœì˜ ë ˆì½”ë“œë§Œ í•„í„°ë§í•˜ê³  ì‚¬ìš©ìë³„ ì‹¤íŒ¨ íšŸìˆ˜ë¥¼ ì§‘ê³„í–ˆìŠµë‹ˆë‹¤.</li>
            <li class="list-item"><strong>ë©”íƒ€ë°ì´í„° íƒœê¹…:</strong> ê³„ì‚°ëœ 'high\_risk\_users' ëª©ë¡ì„ `ControlMessage.set_metadata()`ë¥¼ í†µí•´ ë©”ì‹œì§€ì— ì²¨ë¶€í•˜ì—¬ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ ìŠ¤í…Œì´ì§€ê°€ í›„ì† ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤.</li>
            <li class="list-item"><strong>íŒŒì´í”„ë¼ì¸ ì •í™•ì„± ê²€ì¦:</strong> ê° í•„í„° ë° ë¶„ì„ ë‹¨ê³„ì˜ ì¶œë ¥ì„ `InMemorySinkStage`ë¡œ ë°›ì•„, ê³„ì‚°ëœ ì§€í‘œ ê°’(`failed_count`)ì´ ì •í™•í•œì§€ ê²€ì¦í–ˆìŠµë‹ˆë‹¤.</li>
        </ul>

        <h2>ğŸ“Œ ì£¼ìš” ì½”ë“œ ë¡œì§ (ì‹¤íŒ¨ ë¡œê·¸ì¸ ë¶„ì„ ì¶”ìƒí™”)</h2>
        <div class="code-block">
            <pre># ControlMessageë¥¼ ë°›ì•„ ë³´ì•ˆ ë¶„ì„ì„ ìˆ˜í–‰í•˜ëŠ” ì»¤ìŠ¤í…€ ìŠ¤í…Œì´ì§€ (SinglePortStage ìƒì†)
class FailedLoginAnalysisStage(SinglePortStage):
    def on_data(self, message: ControlMessage) -> ControlMessage:
        with message.payload().mutable_dataframe() as df:
            # 'failure' ìƒíƒœ ë ˆì½”ë“œ í•„í„°ë§ ë° ì‚¬ìš©ìë³„ ì‹¤íŒ¨ íšŸìˆ˜ ì§‘ê³„
            failed_logins = df[df['status'] == 'failure']
            
            if not failed_logins.empty:
                # ì‹¤íŒ¨ íšŸìˆ˜ ê³„ì‚° ë° ì›ë³¸ DataFrameì— ë³‘í•©
                # (cuDF ì—°ì‚°ì„ í†µí•œ GPU ê°€ì† ì²˜ë¦¬)
                df = df.merge(
                    failed_logins.groupby('user').size().reset_index(name='failed_count'), 
                    on='user', 
                    how='left'
                ).fillna({'failed_count': 0})
                
                # ê³ ìœ„í—˜êµ° ì‚¬ìš©ì ëª©ë¡ì„ ë©”ì‹œì§€ ë©”íƒ€ë°ì´í„°ë¡œ íƒœê¹…
                # message.set_metadata("high_risk_users", ...)
                
        return message</pre>
        </div>
    </div>
</body>
</html>


