<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morpheus - ë°ì´í„° ë¶„í•  ë° ë³µì œ ë¡œì§ ìš”ì•½</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f0f4f8; color: #1f2937; }
        .container { max-width: 900px; margin: 2rem auto; padding: 2rem; background: white; border-radius: 1rem; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); }
        .header { border-bottom: 3px solid #14b8a6; padding-bottom: 1rem; margin-bottom: 2rem; }
        h1 { font-size: 2.25rem; font-weight: 700; color: #0f766e; }
        h2 { font-size: 1.5rem; font-weight: 700; color: #14b8a6; margin-top: 1.5rem; border-left: 4px solid #14b8a6; padding-left: 0.75rem; }
        .tag-group { margin-top: 1rem; }
        .tag { display: inline-block; padding: 0.25rem 0.75rem; margin-right: 0.5rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 500; }
        .tag-morpheus { background-color: #ccfbf1; color: #0d9488; }
        .code-block { background-color: #1f2937; color: #e5e7eb; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; font-family: monospace; }
        .list-item { margin-bottom: 0.5rem; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>[Morpheus] ë°ì´í„° ë¶„í•  ë° ë³µì œ ë¡œì§ ìš”ì•½</h1>
            <p class="text-gray-600 mt-2">ì»¤ìŠ¤í…€ ìŠ¤í…Œì´ì§€ë¥¼ í†µí•œ ë©”ì‹œì§€ í˜ì´ë¡œë“œì˜ ì¡°ê±´ë¶€ ë¶„í•  ë° MRC Broadcast í™œìš©</p>
            <div class="tag-group">
                <span class="tag tag-morpheus">Morpheus</span>
            </div>
        </div>

        <h2>í”„ë¡œì íŠ¸ ê°œìš”</h2>
        <p>ë‹¨ì¼ ì…ë ¥ ë©”ì‹œì§€(MessageMeta) ë‚´ì˜ ë°ì´í„°ë¥¼ íŠ¹ì • í•„í„° ì¡°ê±´ì— ë”°ë¼ ë¶„í• í•˜ê³ , ë¶„í• ëœ ë©”ì‹œì§€ì™€ ì›ë³¸ ë©”ì‹œì§€ë¥¼ ê°ê° ë³„ë„ì˜ ì¶œë ¥ í¬íŠ¸ë¡œ ì „ì†¡í•˜ëŠ” **`FilterSplitStage`** ì»¤ìŠ¤í…€ ìŠ¤í…Œì´ì§€ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¹„ì„ í˜• íŒŒì´í”„ë¼ì¸ì—ì„œ ë°ì´í„° ë³µì œ(Broadcast) ë° ì¡°ê±´ë¶€ ë¶„í• (Split)ì„ ìˆ˜í–‰í•˜ëŠ” í•µì‹¬ ê¸°ìˆ ì…ë‹ˆë‹¤.</p>

        <h2>âš™ï¸ ì£¼ìš” ê¸°ìˆ  ë° ì—­í• </h2>
        <ul class="list-disc ml-6 mt-3">
            <li class="list-item"><strong>ê¸°ìˆ :</strong> Morpheus `Stage` (PassThruTypeMixin ë¯¸ì‚¬ìš©), MRC Builder, `MessageMeta` ê°ì²´ ìƒì„±.</li>
            <li class="list-item"><strong>ì¡°ê±´ë¶€ ë°ì´í„° ë¶„í• :</strong> `message.get_data().query()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ í˜ì´ë¡œë“œ(cuDF)ì—ì„œ íŠ¹ì • ì¡°ê±´(ì˜ˆ: ë©”ì‹œì§€ ê¸¸ì´ > 100)ì„ ë§Œì¡±í•˜ëŠ” í–‰ë§Œì„ ë¶„ë¦¬í–ˆìŠµë‹ˆë‹¤.</li>
            <li class="list-item"><strong>ë‹¤ì¤‘ ì¶œë ¥ ê´€ë¦¬:</strong> `self._create_ports(1, 2)`ë¥¼ ì„ ì–¸í•˜ì—¬ 1ê°œì˜ ì…ë ¥ê³¼ 2ê°œì˜ ì¶œë ¥ì„ ì •ì˜í•˜ê³ , `_build` ë©”ì„œë“œì—ì„œ **ë¶„í• ëœ ë°ì´í„°(filtered)**ì™€ **ì›ë³¸ ë°ì´í„°(pass-through)**ë¥¼ ë…ë¦½ì ì¸ ì¶œë ¥ ë…¸ë“œë¡œ ì „ì†¡í–ˆìŠµë‹ˆë‹¤.</li>
            <li class="list-item"><strong>ë©”ì‹œì§€ ë³µì œ(Broadcast):</strong> ë‹¨ì¼ ë©”ì‹œì§€ë¥¼ ì—¬ëŸ¬ ê²½ë¡œë¡œ ì „ë‹¬í•˜ëŠ” MRCì˜ `Broadcast` ê¸°ëŠ¥ì„ ì´í•´í•˜ê³  í™œìš©í–ˆìŠµë‹ˆë‹¤.</li>
        </ul>

        <h2>ğŸ› ï¸ ì£¼ìš” êµ¬í˜„ ë‚´ìš© (FilterSplitStage)</h2>
        <ul class="list-disc ml-6 mt-3">
            <li class="list-item"><strong>ìƒˆ ë©”ì‹œì§€ ìƒì„±:</strong> í•„í„°ë§ëœ ë°ì´í„°í”„ë ˆì„ì„ ì‚¬ìš©í•˜ì—¬ `MessageMeta(ë©”ì‹œì§€.meta_data, filtered_df)`ì™€ ê°™ì´ **ìƒˆë¡œìš´ `MessageMeta` ê°ì²´**ë¥¼ ìƒì„±í•˜ì—¬ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±ì„ ìœ ì§€í–ˆìŠµë‹ˆë‹¤.</li>
            <li class="list-item"><strong>Pass-Through:</strong> ì›ë³¸ ë©”ì‹œì§€ëŠ” ë³€ê²½ ì—†ì´ ë‹¤ë¥¸ ì¶œë ¥ í¬íŠ¸ë¡œ ë³´ë‚´ì ¸, ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ ìŠ¤í…Œì´ì§€ê°€ í•„í„°ë§ëœ ë°ì´í„°ì™€ ì›ë³¸ ë°ì´í„°ë¥¼ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” MIMO êµ¬ì¡°ë¥¼ ì™„ì„±í–ˆìŠµë‹ˆë‹¤.</li>
        </ul>

        <h2>ğŸ“Œ ì£¼ìš” ì½”ë“œ ë¡œì§ (MRC ë…¸ë“œ ë° í¬íŠ¸ ì •ì˜ ì¶”ìƒí™”)</h2>
        <div class="code-block">
            <pre>from morpheus.pipeline import Stage
# ... MRC ì„í¬íŠ¸ ...

class FilterSplitStage(Stage):
    def __init__(self, config, filter_fn):
        super().__init__(config)
        self._filter_fn = filter_fn
        # 1 input, 2 outputs (Filtered data, Original data)
        self._create_ports(1, 2) 

    def _build(self, builder, input_nodes):
        # MRC builderë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì œ ë° ë¶„í•  ë¡œì§ì„ ë‹´ë‹¹í•˜ëŠ” ë…¸ë“œ ìƒì„±
        # MRC ë…¸ë“œë¥¼ í†µí•´ ë‘ ê°œì˜ ë…ë¦½ëœ ì¶œë ¥(outgoing_filtered, outgoing_passthrough) ìƒì„±
        # ... (ë‚´ë¶€ ë¶„í•  ë¡œì§) ...
        
        # Stageì˜ ì¶œë ¥ í¬íŠ¸ì— ëŒ€ì‘í•˜ëŠ” MRC ë…¸ë“œ ë°˜í™˜
        return [outgoing_filtered, outgoing_passthrough]</pre>
        </div>
    </div>
</body>
</html>


