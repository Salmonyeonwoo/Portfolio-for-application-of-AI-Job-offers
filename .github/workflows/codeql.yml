# GitHub Actions를 위한 CodeQL 워크플로우 파일
# 이 파일은 GitHub 저장소의 코드를 자동으로 분석하여 보안 취약점을 찾아줍니다.
name: "CodeQL"

on:
  push:
    branches: [ "main", "develop" ] # main 또는 develop 브랜치에 코드가 push될 때 실행
  schedule:
    - cron: '30 14 * * 1' # 매주 월요일 UTC 14:30 (한국 시간 월요일 밤 11:30)에 정기적으로 실행

jobs:
  analyze:
    name: Analyze
    # ubuntu 최신 버전에서 실행합니다.
    runs-on: ubuntu-latest
    
    permissions:
      actions: read
      contents: read
      security-events: write

    strategy:
      fail-fast: false
      matrix:
        # 💡 중요: 분석할 언어를 명확하게 지정합니다.
        # 이 포트폴리오는 JavaScript 코드를 포함하므로 'javascript-typescript'를 사용합니다.
        language: ['javascript-typescript']
        
    steps:
    - name: Checkout repository
      # actions/checkout@v4 를 사용하여 저장소 코드를 불러옵니다.
      uses: actions/checkout@v4

    # CodeQL 스캔 도구를 초기화합니다.
    - name: Initialize CodeQL
      uses: github/codeql-action/init@v3
      with:
        languages: ${{ matrix.language }}
        # config-file: ./.github/codeql/codeql-config.yml # (필요시 고급 설정 파일 경로)
        # queries: security-and-quality # (분석할 쿼리 종류)

    # CodeQL 분석을 수행합니다.
    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v3
      with:
        category: "/language:${{matrix.language}}"
